---
layout: archive
---

{{ content }}

{%- assign sort_order = page.sort | default: 'last_modified_at' -%}
{%- assign sort_direction = page.sort_direction | default: 'reverse' -%}

{%- if sort_order == 'category' -%}
  {%- comment -%}按分類+日期排序{%- endcomment -%}
  {%- assign posts_by_category = site.posts | group_by: 'categories' -%}
  {%- for category_group in posts_by_category -%}
    {%- assign category_name = category_group.name | first -%}
    {%- if category_name != '' -%}
      <h2 class="archive__subtitle">{{ site.data.ui-text[site.locale].category_page_taxonomy | default: "Posts in" }} {{ category_name }}</h2>
      {%- assign sorted_posts = category_group.items | sort: 'date' | reverse -%}
      {%- for post in sorted_posts -%}
        {%- include archive-single.html -%}
      {%- endfor -%}
    {%- endif -%}
  {%- endfor -%}
{%- else -%}
  {%- comment -%}按更新時間排序（預設）{%- endcomment -%}
  {%- if sort_direction == 'reverse' -%}
    {%- assign sorted_posts = site.posts | sort: sort_order | reverse -%}
  {%- else -%}
    {%- assign sorted_posts = site.posts | sort: sort_order -%}
  {%- endif -%}
  
  {%- assign entries_layout = page.entries_layout | default: 'list' -%}
  <div class="entries-{{ entries_layout }}">
    {%- for post in sorted_posts -%}
      {%- include archive-single.html type=entries_layout -%}
    {%- endfor -%}
  </div>
{%- endif -%}

{%- include paginator.html -%}